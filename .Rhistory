S_amino <- medicine_result_anti_age2 %>%
filter(AGE_G == "senior") %>%
filter(category == "Aminoglycosides")
S_amphe <- medicine_result_anti_age2 %>%
filter(AGE_G == "senior") %>%
filter(category == "Amphenicols")
S_keto <- medicine_result_anti_age2 %>%
filter(AGE_G == "senior") %>%
filter(category == "Ketolides")
S_other <- medicine_result_anti_age2 %>%
filter(AGE_G == "senior") %>%
filter(category == "Other")
## Junior 항생제 분류
J_anti <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
group_by(USE_MONTH, USE_YEAR, AGE_G, date) %>%
summarise(category_pres = sum(category_pres), category_pt = sum(category_pt), .groups = 'drop')
J_peni <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Penicillins")
J_cepha <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Cephalosporins")
J_tetra <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Tetracyclines")
J_macro <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Macrolides")
J_glyco <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Glycopeptides")
J_amino <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Aminoglycosides")
J_amphe <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Amphenicols")
J_keto <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Ketolides")
J_other <- medicine_result_anti_age2 %>%
filter(AGE_G == "junior") %>%
filter(category == "Other")
####그래프 ----
options(scipen = 5)
#Senior(60세 이상), Junior(60세 미만) pt
# S과 J 데이터에 "Source" 열 추가
S_anti$Source <- "senior"
J_anti$Source <- "junior"
# 데이터 결합
age_anti<- rbind(S_anti, J_anti)
# Penicillins 데이터 결합
S_peni$Source <- "senior"
J_peni$Source <- "junior"
age_peni <- rbind(S_peni, J_peni)
# Cephalosporins 데이터 결합
S_cepha$Source <- "senior"
J_cepha$Source <- "junior"
age_cepha <- rbind(S_cepha, J_cepha)
# Tetracyclines 데이터 결합
S_tetra$Source <- "senior"
J_tetra$Source <- "junior"
age_tetra <- rbind(S_tetra, J_tetra)
# Macrolides 데이터 결합
S_macro$Source <- "senior"
J_macro$Source <- "junior"
age_macro<- rbind(S_macro, J_macro)
# Glycopeptides 데이터 결합
S_glyco$Source <- "senior"
J_glyco$Source <- "junior"
age_glyco<- rbind(S_glyco, J_glyco)
# Aminoglycosides 데이터 결합
S_amino$Source <- "senior"
J_amino$Source <- "junior"
age_amino <- rbind(S_amino, J_amino)
# Amphenicols 데이터 결합
S_amphe$Source <- "senior"
J_amphe$Source <- "junior"
age_amphe <- rbind(S_amphe, J_amphe)
# Ketolides 데이터 결합
S_keto$Source <- "senior"
J_keto$Source <- "junior"
age_keto <- rbind(S_keto, J_keto)
# Other 카테고리 데이터 결합
S_other$Source <- "senior"
J_other$Source <- "junior"
age_other <- rbind(S_other, J_other)
#그래프
ggplot(data = combined_data, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = combined_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = combined_peni, aes(color = "Penicillins")) +
geom_point(data = combined_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = combined_cepha, aes(color = "Cephalosporins")) +
geom_point(data = combined_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = combined_tetra, aes(color = "Tetracyclines")) +
geom_point(data = combined_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = combined_macro, aes(color = "Macrolides")) +
geom_point(data = combined_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = combined_glyco, aes(color = "Glycopeptides")) +
geom_point(data = combined_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = combined_amino, aes(color = "Aminoglycosides")) +
geom_point(data = combined_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = combined_amphe, aes(color = "Amphenicols")) +
geom_point(data = combined_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = combined_keto, aes(color = "Ketolides")) +
geom_point(data = combined_other, aes(color = "Other"), size = 1.5) +
geom_line(data = combined_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 10000000)) +
scale_x_date(name="Date", breaks = "12 months", date_labels = "%Y", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category", labels = c("Total(anti)", "Penicillins", "Cephalosporins", "Tetracyclines",
"Macrolides", "Glycopeptides", "Aminoglycosides", "Amphenicols",
"Ketolides", "Other")) +
facet_wrap(~Source) +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#그래프
ggplot(data = class_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = class_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = class_peni, aes(color = "Penicillins")) +
geom_point(data = class_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = class_cepha, aes(color = "Cephalosporins")) +
geom_point(data = class_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = class_tetra, aes(color = "Tetracyclines")) +
geom_point(data = class_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = class_macro, aes(color = "Macrolides")) +
geom_point(data = class_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = class_glyco, aes(color = "Glycopeptides")) +
geom_point(data = class_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = class_amino, aes(color = "Aminoglycosides")) +
geom_point(data = class_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = class_amphe, aes(color = "Amphenicols")) +
geom_point(data = class_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = class_keto, aes(color = "Ketolides")) +
geom_point(data = class_other, aes(color = "Other"), size = 1.5) +
geom_line(data = class_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 8000000)) +
scale_x_date(name=" ", breaks = "12 months", date_labels = "%Y", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "Patient number by Hospital Classification") +
facet_wrap(~Source) +  # 패싯을 추가하여 각 병원 등급 구분
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#상급종합병원(pt,pres)
#상급종합병원 pt
ggplot(data = SC_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = SC_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = SC_peni, aes(color = "Penicillins")) +
geom_point(data = SC_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = SC_cepha, aes(color = "Cephalosporins")) +
geom_point(data = SC_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = SC_tetra, aes(color = "Tetracyclines")) +
geom_point(data = SC_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = SC_macro, aes(color = "Macrolides")) +
geom_point(data = SC_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = SC_glyco, aes(color = "Glycopeptides")) +
geom_point(data = SC_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = SC_amino, aes(color = "Aminoglycosides")) +
geom_point(data = SC_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = SC_amphe, aes(color = "Amphenicols")) +
geom_point(data = SC_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = SC_keto, aes(color = "Ketolides")) +
geom_point(data = SC_other, aes(color = "Other"), size = 1.5) +
geom_line(data = SC_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 250000)) +
scale_x_date(name=" ", breaks = "12 months", date_labels = "%Y", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "상급종합병원 pt") +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#종합병원(pt,pres)
# 종합병원 pt
ggplot(data = C_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = C_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = C_peni, aes(color = "Penicillins")) +
geom_point(data = C_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = C_cepha, aes(color = "Cephalosporins")) +
geom_point(data = C_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = C_tetra, aes(color = "Tetracyclines")) +
geom_point(data = C_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = C_macro, aes(color = "Macrolides")) +
geom_point(data = C_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = C_glyco, aes(color = "Glycopeptides")) +
geom_point(data = C_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = C_amino, aes(color = "Aminoglycosides")) +
geom_point(data = C_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = C_amphe, aes(color = "Amphenicols")) +
geom_point(data = C_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = C_keto, aes(color = "Ketolides")) +
geom_point(data = C_other, aes(color = "Other"), size = 1.5) +
geom_line(data = C_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 1000000)) +
scale_x_date(name=" ", breaks = "12 months", date_labels = "%Y", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "종합병원 pt") +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#병원(pt,pres)
#병원 pt
ggplot(data = H_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = H_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = H_peni, aes(color = "Penicillins")) +
geom_point(data = H_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = H_cepha, aes(color = "Cephalosporins")) +
geom_point(data = H_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = H_tetra, aes(color = "Tetracyclines")) +
geom_point(data = H_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = H_macro, aes(color = "Macrolides")) +
geom_point(data = H_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = H_glyco, aes(color = "Glycopeptides")) +
geom_point(data = H_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = H_amino, aes(color = "Aminoglycosides")) +
geom_point(data = H_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = H_amphe, aes(color = "Amphenicols")) +
geom_point(data = H_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = H_keto, aes(color = "Ketolides")) +
geom_point(data = H_other, aes(color = "Other"), size = 1.5) +
geom_line(data = H_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 1500000)) +
scale_x_date(name=" ", breaks = "12 months", date_labels = "%Y", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "병원 pt") +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#의원(pt,pres)
#의원 pt
ggplot(data = P_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = P_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = P_peni, aes(color = "Penicillins")) +
geom_point(data = P_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = P_cepha, aes(color = "Cephalosporins")) +
geom_point(data = P_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = P_tetra, aes(color = "Tetracyclines")) +
geom_point(data = P_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = P_macro, aes(color = "Macrolides")) +
geom_point(data = P_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = P_glyco, aes(color = "Glycopeptides")) +
geom_point(data = P_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = P_amino, aes(color = "Aminoglycosides")) +
geom_point(data = P_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = P_amphe, aes(color = "Amphenicols")) +
geom_point(data = P_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = P_keto, aes(color = "Ketolides")) +
geom_point(data = P_other, aes(color = "Other"), size = 1.5) +
geom_line(data = P_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 10000000)) +
scale_x_date(name=" ", breaks = "12 months", date_labels = "%Y", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "의원 pt") +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#의원(pt,pres)
#의원 pt
ggplot(data = P_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = P_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = P_peni, aes(color = "Penicillins")) +
geom_point(data = P_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = P_cepha, aes(color = "Cephalosporins")) +
geom_point(data = P_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = P_tetra, aes(color = "Tetracyclines")) +
geom_point(data = P_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = P_macro, aes(color = "Macrolides")) +
geom_point(data = P_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = P_glyco, aes(color = "Glycopeptides")) +
geom_point(data = P_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = P_amino, aes(color = "Aminoglycosides")) +
geom_point(data = P_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = P_amphe, aes(color = "Amphenicols")) +
geom_point(data = P_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = P_keto, aes(color = "Ketolides")) +
geom_point(data = P_other, aes(color = "Other"), size = 1.5) +
geom_line(data = P_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 10000000)) +
scale_x_date(name=" ", breaks = "12 months", date_labels = "%Y%M", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "의원 pt") +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#의원(pt,pres)
#의원 pt
ggplot(data = P_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = P_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = P_peni, aes(color = "Penicillins")) +
geom_point(data = P_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = P_cepha, aes(color = "Cephalosporins")) +
geom_point(data = P_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = P_tetra, aes(color = "Tetracyclines")) +
geom_point(data = P_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = P_macro, aes(color = "Macrolides")) +
geom_point(data = P_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = P_glyco, aes(color = "Glycopeptides")) +
geom_point(data = P_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = P_amino, aes(color = "Aminoglycosides")) +
geom_point(data = P_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = P_amphe, aes(color = "Amphenicols")) +
geom_point(data = P_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = P_keto, aes(color = "Ketolides")) +
geom_point(data = P_other, aes(color = "Other"), size = 1.5) +
geom_line(data = P_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 10000000)) +
scale_x_date(name=" ", breaks = "1 months", date_labels = "%Y%M", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "의원 pt") +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
#의원(pt,pres)
#의원 pt
ggplot(data = P_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = P_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = P_peni, aes(color = "Penicillins")) +
geom_point(data = P_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = P_cepha, aes(color = "Cephalosporins")) +
geom_point(data = P_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = P_tetra, aes(color = "Tetracyclines")) +
geom_point(data = P_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = P_macro, aes(color = "Macrolides")) +
geom_point(data = P_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = P_glyco, aes(color = "Glycopeptides")) +
geom_point(data = P_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = P_amino, aes(color = "Aminoglycosides")) +
geom_point(data = P_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = P_amphe, aes(color = "Amphenicols")) +
geom_point(data = P_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = P_keto, aes(color = "Ketolides")) +
geom_point(data = P_other, aes(color = "Other"), size = 1.5) +
geom_line(data = P_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 10000000)) +
scale_x_date(name=" ", breaks = "3 months", date_labels = "%Y%M", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category") +
labs(title = "의원 pt") +
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
View(P_anti)
#그래프
ggplot(data = sex_anti, aes(x = date, y = category_pt)) +
geom_point(aes(color = "Total(anti)"), size = 1.5) +
geom_line(aes(color = "Total(anti)")) +
geom_point(data = sex_peni, aes(color = "Penicillins"), size = 1.5) +
geom_line(data = sex_peni, aes(color = "Penicillins")) +
geom_point(data = sex_cepha, aes(color = "Cephalosporins"), size = 1.5) +
geom_line(data = sex_cepha, aes(color = "Cephalosporins")) +
geom_point(data = sex_tetra, aes(color = "Tetracyclines"), size = 1.5) +
geom_line(data = sex_tetra, aes(color = "Tetracyclines")) +
geom_point(data = sex_macro, aes(color = "Macrolides"), size = 1.5) +
geom_line(data = sex_macro, aes(color = "Macrolides")) +
geom_point(data = sex_glyco, aes(color = "Glycopeptides"), size = 1.5) +
geom_line(data = sex_glyco, aes(color = "Glycopeptides")) +
geom_point(data = sex_amino, aes(color = "Aminoglycosides"), size = 1.5) +
geom_line(data = sex_amino, aes(color = "Aminoglycosides")) +
geom_point(data = sex_amphe, aes(color = "Amphenicols"), size = 1.5) +
geom_line(data = sex_amphe, aes(color = "Amphenicols")) +
geom_point(data = sex_keto, aes(color = "Ketolides"), size = 1.5) +
geom_line(data = sex_keto, aes(color = "Ketolides")) +
geom_point(data = sex_other, aes(color = "Other"), size = 1.5) +
geom_line(data = sex_other, aes(color = "Other")) +
geom_hline(yintercept = 0, linetype = "solid") +
geom_vline(xintercept = as.numeric(as.Date("2020-01-01")), linetype="dashed") +
geom_vline(xintercept = as.numeric(as.Date("2022-01-01")), linetype="dashed") +
scale_y_continuous(name="Patient Number", limits = c(0, 7500000)) +
scale_x_date(name="Date", breaks = "12 months", date_labels = "%Y", limits = as.Date(c('2018-01-01','2023-09-30'))) +
scale_color_manual(values = c("Total(anti)" = "Black", "Penicillins" = "Blue", "Cephalosporins" = "Red",
"Tetracyclines" = "Green", "Macrolides" = "Purple", "Glycopeptides" = "Brown",
"Aminoglycosides" = "Gray", "Amphenicols" = "Orange", "Ketolides" = "Pink", "Other" = "Turquoise"),
name = "Category", labels = c("Total(anti)", "Penicillins", "Cephalosporins", "Tetracyclines",
"Macrolides", "Glycopeptides", "Aminoglycosides", "Amphenicols",
"Ketolides", "Other")) +
facet_wrap(~Source) +
labs(title = "남녀 pt") +  # 그래프 제목 추가
theme_gray(20) +
theme(panel.background = element_blank(),
panel.grid.major = element_line(color = "grey90", size = 0.5),
axis.ticks = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, face = 'bold'),
axis.text.y = element_text(face = 'bold'),
axis.title.y = element_text(face = 'bold'),
plot.title = element_text(size = rel(1.0)),
legend.title = element_blank())
